2025-11-10 17:00:11,016 | INFO | Logging to: runs/vitb16_text_only/logs/2025-11-10_17-00-11.log
2025-11-10 17:00:11,017 | INFO | ===== Training Configuration =====
2025-11-10 17:00:11,017 | INFO | img_dir: data/Images
2025-11-10 17:00:11,017 | INFO | ann_train: data/train.json
2025-11-10 17:00:11,017 | INFO | ann_val: data/val.json
2025-11-10 17:00:11,017 | INFO | ann_test: None
2025-11-10 17:00:11,017 | INFO | prompt: A high-quality photo of {c} in natural light
2025-11-10 17:00:11,017 | INFO | max_captions_per_image: None
2025-11-10 17:00:11,017 | INFO | model: ViT-B/16
2025-11-10 17:00:11,017 | INFO | batch_size: 128
2025-11-10 17:00:11,017 | INFO | epochs: 20
2025-11-10 17:00:11,017 | INFO | lr: 1e-05
2025-11-10 17:00:11,018 | INFO | weight_decay: 0.2
2025-11-10 17:00:11,018 | INFO | warmup_steps: 500
2025-11-10 17:00:11,018 | INFO | max_grad_norm: 1.0
2025-11-10 17:00:11,018 | INFO | amp: True
2025-11-10 17:00:11,018 | INFO | freeze: text-only
2025-11-10 17:00:11,018 | INFO | num_workers: 4
2025-11-10 17:00:11,018 | INFO | log_every: 20
2025-11-10 17:00:11,018 | INFO | lora: False
2025-11-10 17:00:11,018 | INFO | lora_r: 8
2025-11-10 17:00:11,018 | INFO | lora_alpha: 16
2025-11-10 17:00:11,018 | INFO | lora_dropout: 0.0
2025-11-10 17:00:11,018 | INFO | lora_train_bias: False
2025-11-10 17:00:11,018 | INFO | out: runs/vitb16_text_only
2025-11-10 17:00:11,018 | INFO | resume: None
2025-11-10 17:00:11,018 | INFO | eval_every: 1
2025-11-10 17:00:11,018 | INFO | seed: 42
2025-11-10 17:00:11,019 | INFO | World size=2, Rank=0, Local rank=0
2025-11-10 17:00:18,808 | INFO | [epoch 0] step 20/23  loss=0.6224  lr=3.80e-07  dt=4.7s
2025-11-10 17:00:23,684 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch0.pt
2025-11-10 17:00:27,197 | INFO | [val@epoch1] t2i@1=0.581  i2t@1=0.769  t2i@5=0.833  i2t@5=0.934  t2i@10=0.910  i2t@10=0.973
2025-11-10 17:00:29,929 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:00:29,930 | INFO | [best] epoch=0  score=0.6749  -> saved best.pt
2025-11-10 17:00:33,786 | INFO | [epoch 1] step 20/23  loss=0.5419  lr=8.40e-07  dt=3.9s
2025-11-10 17:00:37,343 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch1.pt
2025-11-10 17:00:40,643 | INFO | [val@epoch2] t2i@1=0.617  i2t@1=0.778  t2i@5=0.863  i2t@5=0.939  t2i@10=0.929  i2t@10=0.974
2025-11-10 17:00:43,396 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:00:43,396 | INFO | [best] epoch=1  score=0.6973  -> saved best.pt
2025-11-10 17:00:47,235 | INFO | [epoch 2] step 20/23  loss=0.5165  lr=1.30e-06  dt=3.8s
2025-11-10 17:00:51,004 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch2.pt
2025-11-10 17:00:54,351 | INFO | [val@epoch3] t2i@1=0.636  i2t@1=0.785  t2i@5=0.879  i2t@5=0.945  t2i@10=0.938  i2t@10=0.972
2025-11-10 17:00:57,281 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:00:57,282 | INFO | [best] epoch=2  score=0.7106  -> saved best.pt
2025-11-10 17:01:01,457 | INFO | [epoch 3] step 20/23  loss=0.3193  lr=1.76e-06  dt=4.2s
2025-11-10 17:01:05,213 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch3.pt
2025-11-10 17:01:08,548 | INFO | [val@epoch4] t2i@1=0.649  i2t@1=0.795  t2i@5=0.890  i2t@5=0.948  t2i@10=0.947  i2t@10=0.981
2025-11-10 17:01:11,164 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:01:11,165 | INFO | [best] epoch=3  score=0.7219  -> saved best.pt
2025-11-10 17:01:15,026 | INFO | [epoch 4] step 20/23  loss=0.2436  lr=2.22e-06  dt=3.9s
2025-11-10 17:01:18,847 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch4.pt
2025-11-10 17:01:22,229 | INFO | [val@epoch5] t2i@1=0.657  i2t@1=0.798  t2i@5=0.896  i2t@5=0.953  t2i@10=0.952  i2t@10=0.977
2025-11-10 17:01:25,199 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:01:25,200 | INFO | [best] epoch=4  score=0.7276  -> saved best.pt
2025-11-10 17:01:29,161 | INFO | [epoch 5] step 20/23  loss=0.3086  lr=2.68e-06  dt=4.0s
2025-11-10 17:01:33,263 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch5.pt
2025-11-10 17:01:36,646 | INFO | [val@epoch6] t2i@1=0.664  i2t@1=0.798  t2i@5=0.899  i2t@5=0.953  t2i@10=0.956  i2t@10=0.982
2025-11-10 17:01:39,607 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:01:39,608 | INFO | [best] epoch=5  score=0.7312  -> saved best.pt
2025-11-10 17:01:43,579 | INFO | [epoch 6] step 20/23  loss=0.2891  lr=3.14e-06  dt=4.0s
2025-11-10 17:01:47,404 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch6.pt
2025-11-10 17:01:50,791 | INFO | [val@epoch7] t2i@1=0.668  i2t@1=0.799  t2i@5=0.903  i2t@5=0.953  t2i@10=0.957  i2t@10=0.982
2025-11-10 17:01:53,884 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:01:53,884 | INFO | [best] epoch=6  score=0.7337  -> saved best.pt
2025-11-10 17:01:57,839 | INFO | [epoch 7] step 20/23  loss=0.2614  lr=3.60e-06  dt=4.0s
2025-11-10 17:02:01,663 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch7.pt
2025-11-10 17:02:05,076 | INFO | [val@epoch8] t2i@1=0.675  i2t@1=0.809  t2i@5=0.906  i2t@5=0.958  t2i@10=0.957  i2t@10=0.985
2025-11-10 17:02:08,280 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:02:08,281 | INFO | [best] epoch=7  score=0.7420  -> saved best.pt
2025-11-10 17:02:12,348 | INFO | [epoch 8] step 20/23  loss=0.3303  lr=4.06e-06  dt=4.1s
2025-11-10 17:02:16,410 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch8.pt
2025-11-10 17:02:19,742 | INFO | [val@epoch9] t2i@1=0.674  i2t@1=0.801  t2i@5=0.912  i2t@5=0.960  t2i@10=0.958  i2t@10=0.980
2025-11-10 17:02:23,742 | INFO | [epoch 9] step 20/23  loss=0.3805  lr=4.52e-06  dt=4.0s
2025-11-10 17:02:27,404 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch9.pt
2025-11-10 17:02:30,868 | INFO | [val@epoch10] t2i@1=0.681  i2t@1=0.802  t2i@5=0.914  i2t@5=0.956  t2i@10=0.960  i2t@10=0.982
2025-11-10 17:02:34,911 | INFO | [epoch 10] step 20/23  loss=0.2600  lr=4.98e-06  dt=4.0s
2025-11-10 17:02:38,901 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch10.pt
2025-11-10 17:02:42,303 | INFO | [val@epoch11] t2i@1=0.683  i2t@1=0.810  t2i@5=0.911  i2t@5=0.959  t2i@10=0.960  i2t@10=0.988
2025-11-10 17:02:45,263 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:02:45,263 | INFO | [best] epoch=10  score=0.7465  -> saved best.pt
2025-11-10 17:02:49,256 | INFO | [epoch 11] step 20/23  loss=0.1895  lr=5.44e-06  dt=4.0s
2025-11-10 17:02:52,914 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch11.pt
2025-11-10 17:02:56,258 | INFO | [val@epoch12] t2i@1=0.682  i2t@1=0.804  t2i@5=0.913  i2t@5=0.965  t2i@10=0.961  i2t@10=0.989
2025-11-10 17:03:00,183 | INFO | [epoch 12] step 20/23  loss=0.2764  lr=5.90e-06  dt=3.9s
2025-11-10 17:03:03,978 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch12.pt
2025-11-10 17:03:07,293 | INFO | [val@epoch13] t2i@1=0.685  i2t@1=0.813  t2i@5=0.915  i2t@5=0.962  t2i@10=0.961  i2t@10=0.990
2025-11-10 17:03:10,222 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:03:10,223 | INFO | [best] epoch=12  score=0.7490  -> saved best.pt
2025-11-10 17:03:14,287 | INFO | [epoch 13] step 20/23  loss=0.2546  lr=6.36e-06  dt=4.1s
2025-11-10 17:03:18,523 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch13.pt
2025-11-10 17:03:21,952 | INFO | [val@epoch14] t2i@1=0.682  i2t@1=0.809  t2i@5=0.915  i2t@5=0.963  t2i@10=0.961  i2t@10=0.989
2025-11-10 17:03:26,120 | INFO | [epoch 14] step 20/23  loss=0.1985  lr=6.82e-06  dt=4.2s
2025-11-10 17:03:29,588 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch14.pt
2025-11-10 17:03:32,969 | INFO | [val@epoch15] t2i@1=0.685  i2t@1=0.805  t2i@5=0.916  i2t@5=0.967  t2i@10=0.959  i2t@10=0.987
2025-11-10 17:03:37,130 | INFO | [epoch 15] step 20/23  loss=0.1810  lr=7.28e-06  dt=4.2s
2025-11-10 17:03:40,705 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch15.pt
2025-11-10 17:03:44,061 | INFO | [val@epoch16] t2i@1=0.684  i2t@1=0.799  t2i@5=0.916  i2t@5=0.964  t2i@10=0.957  i2t@10=0.988
2025-11-10 17:03:48,191 | INFO | [epoch 16] step 20/23  loss=0.1985  lr=7.74e-06  dt=4.1s
2025-11-10 17:03:52,282 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch16.pt
2025-11-10 17:03:55,708 | INFO | [val@epoch17] t2i@1=0.685  i2t@1=0.799  t2i@5=0.915  i2t@5=0.961  t2i@10=0.957  i2t@10=0.987
2025-11-10 17:03:59,810 | INFO | [epoch 17] step 20/23  loss=0.1713  lr=8.20e-06  dt=4.1s
2025-11-10 17:04:03,567 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch17.pt
2025-11-10 17:04:06,911 | INFO | [val@epoch18] t2i@1=0.683  i2t@1=0.792  t2i@5=0.912  i2t@5=0.960  t2i@10=0.955  i2t@10=0.988
2025-11-10 17:04:11,003 | INFO | [epoch 18] step 20/23  loss=0.1882  lr=8.66e-06  dt=4.1s
2025-11-10 17:04:14,546 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch18.pt
2025-11-10 17:04:17,914 | INFO | [val@epoch19] t2i@1=0.685  i2t@1=0.809  t2i@5=0.912  i2t@5=0.971  t2i@10=0.955  i2t@10=0.993
2025-11-10 17:04:21,898 | INFO | [epoch 19] step 20/23  loss=0.1342  lr=9.12e-06  dt=4.0s
2025-11-10 17:04:25,792 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch19.pt
2025-11-10 17:04:29,259 | INFO | [val@epoch20] t2i@1=0.674  i2t@1=0.799  t2i@5=0.909  i2t@5=0.969  t2i@10=0.958  i2t@10=0.989
2025-11-10 17:04:32,670 | INFO | [val_final] t2i@1=0.674  i2t@1=0.799  t2i@5=0.909  i2t@5=0.969  t2i@10=0.958  i2t@10=0.989
2025-11-10 17:04:32,670 | INFO | ===== Training Complete =====
2025-11-10 17:04:32,670 | INFO | Total time: 0:04:18.559209
2025-11-10 17:04:32,670 | INFO | Best epoch: 12, best score: 0.7490
2025-11-10 17:04:32,670 | INFO | Logs saved to: runs/vitb16_text_only/logs/2025-11-10_17-00-11.log
2025-11-10 17:04:32,671 | INFO | CSV saved to:  runs/vitb16_text_only/logs/2025-11-10_17-00-11.csv
2025-11-10 17:04:32,671 | INFO | Checkpoints dir: runs/vitb16_text_only
