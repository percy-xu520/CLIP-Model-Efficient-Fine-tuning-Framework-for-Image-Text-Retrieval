2025-11-10 17:05:53,253 | INFO | Logging to: runs/vitb16_text_only/logs/2025-11-10_17-05-53.log
2025-11-10 17:05:53,254 | INFO | ===== Training Configuration =====
2025-11-10 17:05:53,254 | INFO | img_dir: data/Images
2025-11-10 17:05:53,254 | INFO | ann_train: data/train.json
2025-11-10 17:05:53,254 | INFO | ann_val: data/val.json
2025-11-10 17:05:53,255 | INFO | ann_test: None
2025-11-10 17:05:53,255 | INFO | prompt: A clear visual representation of {c}, focus on key features
2025-11-10 17:05:53,255 | INFO | max_captions_per_image: None
2025-11-10 17:05:53,255 | INFO | model: ViT-B/16
2025-11-10 17:05:53,255 | INFO | batch_size: 128
2025-11-10 17:05:53,255 | INFO | epochs: 20
2025-11-10 17:05:53,255 | INFO | lr: 1e-05
2025-11-10 17:05:53,255 | INFO | weight_decay: 0.2
2025-11-10 17:05:53,255 | INFO | warmup_steps: 500
2025-11-10 17:05:53,255 | INFO | max_grad_norm: 1.0
2025-11-10 17:05:53,255 | INFO | amp: True
2025-11-10 17:05:53,255 | INFO | freeze: text-only
2025-11-10 17:05:53,255 | INFO | num_workers: 4
2025-11-10 17:05:53,255 | INFO | log_every: 20
2025-11-10 17:05:53,255 | INFO | lora: False
2025-11-10 17:05:53,255 | INFO | lora_r: 8
2025-11-10 17:05:53,255 | INFO | lora_alpha: 16
2025-11-10 17:05:53,256 | INFO | lora_dropout: 0.0
2025-11-10 17:05:53,256 | INFO | lora_train_bias: False
2025-11-10 17:05:53,256 | INFO | out: runs/vitb16_text_only
2025-11-10 17:05:53,256 | INFO | resume: None
2025-11-10 17:05:53,256 | INFO | eval_every: 1
2025-11-10 17:05:53,256 | INFO | seed: 42
2025-11-10 17:05:53,256 | INFO | World size=2, Rank=0, Local rank=0
2025-11-10 17:06:01,293 | INFO | [epoch 0] step 20/23  loss=0.6842  lr=3.80e-07  dt=5.0s
2025-11-10 17:06:05,805 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch0.pt
2025-11-10 17:06:09,498 | INFO | [val@epoch1] t2i@1=0.565  i2t@1=0.750  t2i@5=0.829  i2t@5=0.932  t2i@10=0.906  i2t@10=0.973
2025-11-10 17:06:12,391 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:06:12,391 | INFO | [best] epoch=0  score=0.6575  -> saved best.pt
2025-11-10 17:06:16,380 | INFO | [epoch 1] step 20/23  loss=0.5442  lr=8.40e-07  dt=4.0s
2025-11-10 17:06:20,374 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch1.pt
2025-11-10 17:06:23,798 | INFO | [val@epoch2] t2i@1=0.606  i2t@1=0.766  t2i@5=0.858  i2t@5=0.948  t2i@10=0.928  i2t@10=0.977
2025-11-10 17:06:26,880 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:06:26,881 | INFO | [best] epoch=1  score=0.6861  -> saved best.pt
2025-11-10 17:06:30,828 | INFO | [epoch 2] step 20/23  loss=0.5532  lr=1.30e-06  dt=3.9s
2025-11-10 17:06:34,932 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch2.pt
2025-11-10 17:06:38,324 | INFO | [val@epoch3] t2i@1=0.636  i2t@1=0.777  t2i@5=0.879  i2t@5=0.940  t2i@10=0.941  i2t@10=0.978
2025-11-10 17:06:41,233 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:06:41,234 | INFO | [best] epoch=2  score=0.7064  -> saved best.pt
2025-11-10 17:06:45,149 | INFO | [epoch 3] step 20/23  loss=0.3313  lr=1.76e-06  dt=3.9s
2025-11-10 17:06:49,217 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch3.pt
2025-11-10 17:06:52,567 | INFO | [val@epoch4] t2i@1=0.650  i2t@1=0.780  t2i@5=0.889  i2t@5=0.948  t2i@10=0.948  i2t@10=0.981
2025-11-10 17:06:55,583 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:06:55,584 | INFO | [best] epoch=3  score=0.7150  -> saved best.pt
2025-11-10 17:06:59,531 | INFO | [epoch 4] step 20/23  loss=0.2281  lr=2.22e-06  dt=3.9s
2025-11-10 17:07:03,300 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch4.pt
2025-11-10 17:07:06,656 | INFO | [val@epoch5] t2i@1=0.661  i2t@1=0.785  t2i@5=0.896  i2t@5=0.943  t2i@10=0.951  i2t@10=0.983
2025-11-10 17:07:09,315 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:07:09,315 | INFO | [best] epoch=4  score=0.7228  -> saved best.pt
2025-11-10 17:07:13,471 | INFO | [epoch 5] step 20/23  loss=0.3090  lr=2.68e-06  dt=4.2s
2025-11-10 17:07:17,195 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch5.pt
2025-11-10 17:07:20,555 | INFO | [val@epoch6] t2i@1=0.664  i2t@1=0.798  t2i@5=0.896  i2t@5=0.948  t2i@10=0.955  i2t@10=0.982
2025-11-10 17:07:23,531 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:07:23,532 | INFO | [best] epoch=5  score=0.7310  -> saved best.pt
2025-11-10 17:07:27,372 | INFO | [epoch 6] step 20/23  loss=0.2777  lr=3.14e-06  dt=3.8s
2025-11-10 17:07:30,994 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch6.pt
2025-11-10 17:07:34,319 | INFO | [val@epoch7] t2i@1=0.668  i2t@1=0.799  t2i@5=0.904  i2t@5=0.953  t2i@10=0.956  i2t@10=0.983
2025-11-10 17:07:37,452 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:07:37,453 | INFO | [best] epoch=6  score=0.7337  -> saved best.pt
2025-11-10 17:07:41,437 | INFO | [epoch 7] step 20/23  loss=0.2658  lr=3.60e-06  dt=4.0s
2025-11-10 17:07:45,156 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch7.pt
2025-11-10 17:07:48,479 | INFO | [val@epoch8] t2i@1=0.673  i2t@1=0.808  t2i@5=0.906  i2t@5=0.958  t2i@10=0.956  i2t@10=0.987
2025-11-10 17:07:51,575 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:07:51,576 | INFO | [best] epoch=7  score=0.7406  -> saved best.pt
2025-11-10 17:07:55,407 | INFO | [epoch 8] step 20/23  loss=0.3406  lr=4.06e-06  dt=3.8s
2025-11-10 17:07:59,021 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch8.pt
2025-11-10 17:08:02,441 | INFO | [val@epoch9] t2i@1=0.672  i2t@1=0.800  t2i@5=0.911  i2t@5=0.963  t2i@10=0.958  i2t@10=0.990
2025-11-10 17:08:06,775 | INFO | [epoch 9] step 20/23  loss=0.3697  lr=4.52e-06  dt=4.3s
2025-11-10 17:08:10,328 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch9.pt
2025-11-10 17:08:13,677 | INFO | [val@epoch10] t2i@1=0.677  i2t@1=0.801  t2i@5=0.912  i2t@5=0.957  t2i@10=0.959  i2t@10=0.988
2025-11-10 17:08:17,825 | INFO | [epoch 10] step 20/23  loss=0.2581  lr=4.98e-06  dt=4.1s
2025-11-10 17:08:21,530 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch10.pt
2025-11-10 17:08:24,917 | INFO | [val@epoch11] t2i@1=0.678  i2t@1=0.811  t2i@5=0.913  i2t@5=0.961  t2i@10=0.961  i2t@10=0.988
2025-11-10 17:08:27,679 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:08:27,680 | INFO | [best] epoch=10  score=0.7446  -> saved best.pt
2025-11-10 17:08:31,719 | INFO | [epoch 11] step 20/23  loss=0.1824  lr=5.44e-06  dt=4.0s
2025-11-10 17:08:35,309 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch11.pt
2025-11-10 17:08:38,682 | INFO | [val@epoch12] t2i@1=0.681  i2t@1=0.802  t2i@5=0.913  i2t@5=0.964  t2i@10=0.960  i2t@10=0.988
2025-11-10 17:08:42,845 | INFO | [epoch 12] step 20/23  loss=0.2675  lr=5.90e-06  dt=4.2s
2025-11-10 17:08:46,553 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch12.pt
2025-11-10 17:08:49,938 | INFO | [val@epoch13] t2i@1=0.681  i2t@1=0.807  t2i@5=0.916  i2t@5=0.961  t2i@10=0.960  i2t@10=0.990
2025-11-10 17:08:54,162 | INFO | [epoch 13] step 20/23  loss=0.2583  lr=6.36e-06  dt=4.2s
2025-11-10 17:08:57,844 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch13.pt
2025-11-10 17:09:01,208 | INFO | [val@epoch14] t2i@1=0.679  i2t@1=0.812  t2i@5=0.913  i2t@5=0.960  t2i@10=0.958  i2t@10=0.988
2025-11-10 17:09:04,152 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:09:04,152 | INFO | [best] epoch=13  score=0.7453  -> saved best.pt
2025-11-10 17:09:08,353 | INFO | [epoch 14] step 20/23  loss=0.2051  lr=6.82e-06  dt=4.2s
2025-11-10 17:09:11,882 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch14.pt
2025-11-10 17:09:15,241 | INFO | [val@epoch15] t2i@1=0.684  i2t@1=0.810  t2i@5=0.913  i2t@5=0.962  t2i@10=0.960  i2t@10=0.986
2025-11-10 17:09:18,560 | INFO | [ckpt] saved to runs/vitb16_text_only/best.pt
2025-11-10 17:09:18,560 | INFO | [best] epoch=14  score=0.7471  -> saved best.pt
2025-11-10 17:09:22,656 | INFO | [epoch 15] step 20/23  loss=0.1849  lr=7.28e-06  dt=4.1s
2025-11-10 17:09:26,372 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch15.pt
2025-11-10 17:09:29,767 | INFO | [val@epoch16] t2i@1=0.686  i2t@1=0.802  t2i@5=0.915  i2t@5=0.959  t2i@10=0.957  i2t@10=0.990
2025-11-10 17:09:33,892 | INFO | [epoch 16] step 20/23  loss=0.2040  lr=7.74e-06  dt=4.1s
2025-11-10 17:09:37,776 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch16.pt
2025-11-10 17:09:41,114 | INFO | [val@epoch17] t2i@1=0.685  i2t@1=0.805  t2i@5=0.915  i2t@5=0.960  t2i@10=0.959  i2t@10=0.990
2025-11-10 17:09:45,161 | INFO | [epoch 17] step 20/23  loss=0.1757  lr=8.20e-06  dt=4.0s
2025-11-10 17:09:49,725 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch17.pt
2025-11-10 17:09:53,119 | INFO | [val@epoch18] t2i@1=0.684  i2t@1=0.803  t2i@5=0.915  i2t@5=0.964  t2i@10=0.956  i2t@10=0.988
2025-11-10 17:09:57,274 | INFO | [epoch 18] step 20/23  loss=0.1976  lr=8.66e-06  dt=4.2s
2025-11-10 17:10:01,821 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch18.pt
2025-11-10 17:10:05,202 | INFO | [val@epoch19] t2i@1=0.684  i2t@1=0.810  t2i@5=0.914  i2t@5=0.968  t2i@10=0.957  i2t@10=0.992
2025-11-10 17:10:09,401 | INFO | [epoch 19] step 20/23  loss=0.1420  lr=9.12e-06  dt=4.2s
2025-11-10 17:10:13,094 | INFO | [ckpt] saved to runs/vitb16_text_only/ckpt_epoch19.pt
2025-11-10 17:10:16,472 | INFO | [val@epoch20] t2i@1=0.680  i2t@1=0.808  t2i@5=0.911  i2t@5=0.963  t2i@10=0.959  i2t@10=0.987
2025-11-10 17:10:19,878 | INFO | [val_final] t2i@1=0.680  i2t@1=0.808  t2i@5=0.911  i2t@5=0.963  t2i@10=0.959  i2t@10=0.987
2025-11-10 17:10:19,879 | INFO | ===== Training Complete =====
2025-11-10 17:10:19,879 | INFO | Total time: 0:04:23.588514
2025-11-10 17:10:19,879 | INFO | Best epoch: 14, best score: 0.7471
2025-11-10 17:10:19,879 | INFO | Logs saved to: runs/vitb16_text_only/logs/2025-11-10_17-05-53.log
2025-11-10 17:10:19,879 | INFO | CSV saved to:  runs/vitb16_text_only/logs/2025-11-10_17-05-53.csv
2025-11-10 17:10:19,879 | INFO | Checkpoints dir: runs/vitb16_text_only
